(function(d,k){function m(h,i){var a=this;a.$el=d(h);a.el=h;a.id=n++;a.$window=d(k);a.$document=d(document);a.$el.bind("destroyed",d.proxy(a.teardown,a));a.$clonedHeader=null;a.$originalHeader=null;a.isSticky=false;a.hasBeenSticky=false;a.leftOffset=null;a.topOffset=null;a.init=function(){a.$el.each(function(){var c=d(this);c.css("padding",0);a.$originalHeader=d("thead:first",this);a.$clonedHeader=a.$originalHeader.clone();c.trigger("clonedHeader."+f,[a.$clonedHeader]);a.$clonedHeader.addClass("tableFloatingHeader");
a.$clonedHeader.css("display","none");a.$originalHeader.addClass("tableFloatingHeaderOriginal");a.$originalHeader.after(a.$clonedHeader);a.$printStyle=d('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>');d("head").append(a.$printStyle)});a.setOptions(i);a.updateWidth();a.toggleHeaders();a.bind()};a.destroy=function(){a.$el.unbind("destroyed",a.teardown);a.teardown()};a.teardown=function(){a.isSticky&&
a.$originalHeader.css("position","static");d.removeData(a.el,"plugin_"+f);a.unbind();a.$clonedHeader.remove();a.$originalHeader.removeClass("tableFloatingHeaderOriginal");a.$originalHeader.css("visibility","visible");a.$printStyle.remove();a.el=null;a.$el=null};a.bind=function(){a.$scrollableArea.on("scroll."+f,a.toggleHeaders);if(!a.isWindowScrolling){a.$window.on("scroll."+f+a.id,a.setPositionValues);a.$window.on("resize."+f+a.id,a.toggleHeaders)}a.$scrollableArea.on("resize."+f,a.toggleHeaders);
a.$scrollableArea.on("resize."+f,a.updateWidth)};a.unbind=function(){a.$scrollableArea.off("."+f,a.toggleHeaders);if(!a.isWindowScrolling){a.$window.off("."+f+a.id,a.setPositionValues);a.$window.off("."+f+a.id,a.toggleHeaders)}a.$scrollableArea.off("."+f,a.updateWidth)};a.toggleHeaders=function(){a.$el&&a.$el.each(function(){var c=d(this),e,g=a.isWindowScrolling?isNaN(a.options.fixedOffset)?a.options.fixedOffset.outerHeight():a.options.fixedOffset:a.$scrollableArea.offset().top+(!isNaN(a.options.fixedOffset)?
a.options.fixedOffset:0);e=c.offset();var b=a.$scrollableArea.scrollTop()+g,j=a.$scrollableArea.scrollLeft(),l=a.isWindowScrolling?b>e.top:g>e.top;c=(a.isWindowScrolling?b:0)<e.top+c.height()-a.$clonedHeader.height()-(a.isWindowScrolling?0:g);if(l&&c){e=e.left-j+a.options.leftOffset;a.$originalHeader.css({position:"fixed","margin-top":a.options.marginTop,left:e,"z-index":3});a.leftOffset=e;a.topOffset=g;a.$clonedHeader.css("display","");if(!a.isSticky){a.isSticky=true;a.updateWidth()}a.setPositionValues()}else if(a.isSticky){a.$originalHeader.css("position",
"static");a.$clonedHeader.css("display","none");a.isSticky=false;a.resetWidth(d("td,th",a.$clonedHeader),d("td,th",a.$originalHeader))}})};a.setPositionValues=function(){var c=a.$window.scrollTop(),e=a.$window.scrollLeft();!a.isSticky||c<0||c+a.$window.height()>a.$document.height()||e<0||e+a.$window.width()>a.$document.width()||a.$originalHeader.css({top:a.topOffset-(a.isWindowScrolling?0:c),left:a.leftOffset-(a.isWindowScrolling?0:e)})};a.updateWidth=function(){if(a.isSticky){if(!a.$originalHeaderCells)a.$originalHeaderCells=
d("th,td",a.$originalHeader);if(!a.$clonedHeaderCells)a.$clonedHeaderCells=d("th,td",a.$clonedHeader);var c=a.getWidth(a.$clonedHeaderCells);a.setWidth(c,a.$clonedHeaderCells,a.$originalHeaderCells);a.$originalHeader.css("width",a.$clonedHeader.width())}};a.getWidth=function(c){var e=[];c.each(function(g){var b;b=d(this);if(b.css("box-sizing")==="border-box"){b=b[0].getBoundingClientRect();b=b.width?b.width:b.right-b.left}else if(d("th",a.$originalHeader).css("border-collapse")==="collapse")if(k.getComputedStyle)b=
parseFloat(k.getComputedStyle(this,null).width);else{var j=parseFloat(b.css("padding-left")),l=parseFloat(b.css("padding-right")),o=parseFloat(b.css("border-width"));b=b.outerWidth()-j-l-o}else b=b.width();e[g]=b});return e};a.setWidth=function(c,e,g){e.each(function(b){var j=c[b];g.eq(b).css({"min-width":j,"max-width":j})})};a.resetWidth=function(c,e){c.each(function(g){var b=d(this);e.eq(g).css({"min-width":b.css("min-width"),"max-width":b.css("max-width")})})};a.setOptions=function(c){a.options=
d.extend({},p,c);a.$scrollableArea=d(a.options.scrollableArea);a.isWindowScrolling=a.$scrollableArea[0]===k};a.updateOptions=function(c){a.setOptions(c);a.unbind();a.bind();a.updateWidth();a.toggleHeaders()};a.init()}var f="stickyTableHeaders",n=0,p={fixedOffset:0,leftOffset:0,marginTop:0,scrollableArea:k};d.fn[f]=function(h){return this.each(function(){var i=d.data(this,"plugin_"+f);if(i)typeof h==="string"?i[h].apply(i):i.updateOptions(h);else h!=="destroy"&&d.data(this,"plugin_"+f,new m(this,h))})}})(jQuery,
window);
